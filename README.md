# genome_editing_ISS

The files here are used for image analysis and quantification of genome editing using imaging-based in situ sequencing (ISS) in native tissue sections.
For details: see publication (link to be added)
For a detailed protocol on tissue processing, library preparation and imaging: see (link to be added)

The image analysis and quantification pipeline consists of two parts:
Step 1. Image processing using CellProfiler
Step 2. Base calling using the intensity measurement data exported from the previous step

Below is a brief description on how to use the CellProfiler pipeline and the accompanying code. 

Installation: git clone https://github.com/sharan-j/genome_editing_ISS.git

Pre-requisites:
1. CellProfiler (minimum version 4.1.3)
2. R version (minimum version 3.5.2)
    R packages:
        tidyverse version 2.0.0
        reshape2 version 1.4.4
        tiff version 0.1-11
        imager version 0.42.18

Pre-processing: 
A detailed protocol for tissue processing, library preparation and imaging can be found here (link to be added)

Usage:

Step 1. Image processing using CellProfiler

Input:
The input files for step 1 are the .tiff files generated upon the sequencing-by-sythesis step of ISS.
Briefly, the CellProfiler pipeline takes as input:
1. the .tiff files containing costaining for the cell types of interest (For example, Ecad and phalloidin on murine liver tissue sections).
2. the .tiff files for each sequencing-by-synthesis cycle, one image per cycle.

The images are maximum projections of the Z-stacks and (if required) background subtracted. 
Load the images into the accompanying CellProfiler pipeline and follow the steps as described in the description box of each step. 

Output:
The output generated by CellProfiler is a tab-separated file containing the intesity measurement of each detected RCP and the accompanying meta data.

Step 2. Base calling using the intensity measurement data exported from the previous step

Input:
The R script takes as input 
1. Tab-separated files containing the intensity measurements of RCPs and 
2. Tab-seperated reference file containg the reference barcodes.

Set the path name to the input files in the R script and run the code.

Output: 
The output is a tab-separated table containing the percentage of edited and unedited cells quantified in each image.


